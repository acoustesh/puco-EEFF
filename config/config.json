{
  "_description": "Shared project configuration for puco-EEFF. Sheet-specific configs are in config/<sheet_name>/.",

  "period_types": {
    "quarterly": {
      "key_format": "{year}_Q{period}",
      "display_format": "{roman}Q{year}",
      "periods_per_year": 4,
      "roman_numerals": {"1": "I", "2": "II", "3": "III", "4": "IV"}
    },
    "monthly": {
      "key_format": "{year}_M{period:02d}",
      "display_format": "{period:02d}-{year}",
      "periods_per_year": 12
    },
    "yearly": {
      "key_format": "{year}_FY",
      "display_format": "FY{year}",
      "periods_per_year": 1
    }
  },

  "file_patterns": {
    "analisis_razonado": {
      "pattern": "analisis_razonado_{year}_Q{quarter}.pdf",
      "description": "Management Discussion and Analysis (MD&A)"
    },
    "estados_financieros_pdf": {
      "pattern": "estados_financieros_{year}_Q{quarter}.pdf",
      "description": "Financial Statements PDF"
    },
    "estados_financieros_xbrl": {
      "pattern": "estados_financieros_{year}_Q{quarter}.xbrl",
      "alt_patterns": ["estados_financieros_{year}_Q{quarter}.xml"],
      "description": "Financial Statements XBRL/XML"
    },
    "xbrl_zip": {
      "pattern": "estados_financieros_{year}_Q{quarter}_xbrl.zip",
      "description": "XBRL package download"
    },
    "pucobre_combined": {
      "pattern": "pucobre_combined_{year}_Q{quarter}.pdf",
      "description": "Combined PDF from pucobre.cl fallback source"
    }
  },

  "sources": {
    "cmf_chile": {
      "name": "CMF Chile - Pucobre EEFF",
      "base_url": "https://www.cmfchile.cl/institucional/mercados/entidad.php?mercado=V&rut=96561560&grupo=&tipoentidad=RVEMI&row=&vig=VI&control=svs&pestania=3",
      "description": "Portal de información financiera CMF Chile - All downloads from single source",
      "entity": {
        "name": "Sociedad Punta del Cobre S.A.",
        "rut": "96561560"
      },
      "filters": {
        "selectors": {
          "month": "select[name='mm']",
          "year": "select[name='aa']",
          "tipo": "select[name='tipo']",
          "tipo_norma": "select[name='tipo_norma']",
          "submit": "input[value='Consultar']"
        },
        "default_values": {
          "tipo": "C",
          "tipo_norma": "IFRS",
          "_tipo_options": {
            "C": "Consolidado",
            "I": "Individual"
          },
          "_tipo_norma_options": {
            "IFRS": "Estándar IFRS",
            "NCH": "Norma Chilena"
          }
        },
        "month_to_quarter": {
          "03": 1,
          "06": 2,
          "09": 3,
          "12": 4
        },
        "quarter_to_month": {
          "1": "03",
          "2": "06",
          "3": "09",
          "4": "12"
        }
      },
      "downloads": {
        "analisis_razonado": {
          "link_text": "Análisis Razonado",
          "filename_pattern": "analisis_razonado_{year}_Q{quarter}.pdf",
          "description": "Management Discussion and Analysis (MD&A)"
        },
        "estados_financieros_pdf": {
          "link_text": "Estados financieros (PDF)",
          "filename_pattern": "estados_financieros_{year}_Q{quarter}.pdf",
          "description": "Financial Statements PDF"
        },
        "estados_financieros_xbrl": {
          "link_text": "Estados financieros (XBRL)",
          "filename_pattern": "estados_financieros_{year}_Q{quarter}_xbrl.zip",
          "description": "Financial Statements XBRL/XML package"
        }
      }
    },
    "pucobre": {
      "name": "Pucobre.cl - Estados Financieros",
      "base_url": "https://www.pucobre.cl/OpenDocs/asp/pagDefault.asp?boton=Doc51&argInstanciaId=51&argCarpetaId=32&argTreeNodosAbiertos=(32)&argTreeNodoActual=32&argTreeNodoSel=32",
      "description": "Fallback source - Pucobre company website. Only has PDF Estados Financieros (no XBRL, no Análisis Razonado).",
      "entity": {
        "name": "Sociedad Punta del Cobre S.A.",
        "website": "https://www.pucobre.cl"
      },
      "link_pattern": "Estados Financieros {date}",
      "date_format": "DD-MM-YYYY",
      "quarter_to_date": {
        "1": "31-03",
        "2": "30-06",
        "3": "30-09",
        "4": "31-12"
      },
      "downloads": {
        "estados_financieros_pdf": {
          "filename_pattern": "estados_financieros_{year}_Q{quarter}.pdf",
          "description": "Financial Statements PDF (same content as CMF)"
        }
      },
      "notes": [
        "Use as fallback when CMF Chile doesn't have the data",
        "Q1 data is typically available here before CMF publishes Q2",
        "Only provides PDF - no XBRL or Análisis Razonado"
      ]
    }
  },

  "ocr": {
    "primary": {
      "provider": "mistral",
      "model": "mistral-ocr-latest"
    },
    "fallback": [
      {"provider": "openrouter", "model": "anthropic/claude-3.5-sonnet", "description": "Anthropic Claude via OpenRouter"},
      {"provider": "openrouter", "model": "openai/gpt-4o", "description": "OpenAI GPT-4o via OpenRouter"}
    ],
    "retry": {
      "max_attempts": 3,
      "strategy": "exponential",
      "base_delay_seconds": 1,
      "max_delay_seconds": 30
    },
    "save_all_responses": true
  },

  "output": {
    "filename_pattern": "EEFF_{year}_Q{quarter}.xlsx",
    "date_format": "YYYY_QN"
  },

  "logging": {
    "format": "simple",
    "filename_pattern": "{date}_run.log"
  },

  "temp_files": {
    "directory": "temp",
    "auto_cleanup": true,
    "page_extraction_prefix": "page_review_"
  }
}
